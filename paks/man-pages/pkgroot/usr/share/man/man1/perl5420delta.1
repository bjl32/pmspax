.\" -*- mode: troff; coding: utf-8 -*-
.\" Automatically generated by Pod::Man v6.0.2 (Pod::Simple 3.45)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" \*(C` and \*(C' are quotes in nroff, nothing in troff, for use with C<>.
.ie n \{\
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is >0, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{\
.    if \nF \{\
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{\
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\"
.\" Required to disable full justification in groff 1.23.0.
.if n .ds AD l
.\" ========================================================================
.\"
.IX Title "PERL5420DELTA 1"
.TH PERL5420DELTA 1 2025-07-02 "perl v5.42.0" "Perl Programmers Reference Guide"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH NAME
perldelta \- what is new for perl v5.42.0
.SH DESCRIPTION
.IX Header "DESCRIPTION"
This document describes differences between the 5.42.0 release and the 5.40.0
release.
.SH "Core Enhancements"
.IX Header "Core Enhancements"
.SS "More CORE:: subs"
.IX Subsection "More CORE:: subs"
\&\f(CW\*(C`chdir\*(C'\fR has been added as a subroutine to the \f(CW\*(C`CORE::\*(C'\fR namespace.
.PP
Previously, code like \f(CW&CORE::chdir($dir)\fR or \f(CWmy $ref = \e&CORE::chdir;
$ref\->($dir)\fR would throw an error saying \f(CW\*(C`&CORE::chdir cannot be called
directly\*(C'\fR. These cases are now fully supported.
.ie n .SS "New pragma ""source::encoding"""
.el .SS "New pragma \f(CWsource::encoding\fP"
.IX Subsection "New pragma source::encoding"
This allows you to declare that the portion of a program for the
remainder of the lexical scope of this pragma is encoded either entirely
in ASCII (for \f(CW\*(C`use\ source::encoding\ \*(Aqascii\*(Aq\*(C'\fR) or if UTF\-8 is allowed
as well (for \f(CW\*(C`use\ source::encoding\ \*(Aqutf8\*(Aq\*(C'\fR). No other encodings are
accepted. The second form is entirely equivalent to \f(CW\*(C`use\ utf8\*(C'\fR, and
may be used interchangeably with that.
.PP
The purpose of this pragma is to catch cases early where you forgot to
specify \f(CW\*(C`use\ utf8\*(C'\fR.
.PP
\&\f(CW\*(C`use\ source::encoding\ \*(Aqascii\*(Aq\*(C'\fR is automatically enabled within the
lexical scope of a \f(CW\*(C`use\ v5.41.0\*(C'\fR or higher.
.PP
\&\f(CW\*(C`no\ source::encoding\*(C'\fR turns off all this checking for the remainder of
its lexical scope. The meaning of non\-ASCII characters is then undefined.
.ie n .SS "New "":writer"" attribute on field variables"
.el .SS "New \f(CW:writer\fP attribute on field variables"
.IX Subsection "New :writer attribute on field variables"
Classes defined using \f(CW\*(C`use feature \*(Aqclass\*(Aq\*(C'\fR are now able to automatically
create writer accessors for scalar fields, by using the \f(CW\*(C`:writer\*(C'\fR attribute,
similar to the way that \f(CW\*(C`:reader\*(C'\fR already creates reader accessors.
.PP
.Vb 4
\&    class Point {
\&        field $x :reader :writer :param;
\&        field $y :reader :writer :param;
\&    }
\&
\&    my $p = Point\->new( x => 20, y => 40 );
\&    $p\->set_x(60);
.Ve
.ie n .SS "New ""any"" and ""all"" operators"
.el .SS "New \f(CWany\fP and \f(CWall\fP operators"
.IX Subsection "New any and all operators"
Two new experimental features have been added, which introduce the
list\-processing operators \f(CW\*(C`any\*(C'\fR and \f(CW\*(C`all\*(C'\fR.
.PP
.Vb 3
\&    use v5.42;
\&    use feature \*(Aqkeyword_all\*(Aq;
\&    no warnings \*(Aqexperimental::keyword_all\*(Aq;
\&
\&    my @numbers = ...
\&
\&    if ( all { $_ % 2 == 0 } @numbers ) {
\&        say "All the numbers are even";
\&    }
.Ve
.PP
These keywords operate similarly to \f(CW\*(C`grep\*(C'\fR except that they only
ever return true or false, testing if any (or all) of the elements in
the list make the testing block yield true.  Because of this they can
short\-circuit, avoiding the need to test any further elements if a given
element determines the eventual result.
.PP
These are inspired by the same\-named functions in the List::Util module,
except that they are implemented as direct core operators, and thus perform
faster, and do not produce an additional subroutine call stack frame for
invoking the code block.
.PP
The feature flags enabling those keywords have been named
\&\f(CW\*(C`keyword_any\*(C'\fR
and \f(CW\*(C`keyword_all\*(C'\fR
to avoid confusion with the ability of the \f(CW\*(C`feature\*(C'\fR module
to refer to all of its features by using the \f(CW\*(C`:all\*(C'\fR
export tag.  [GH #23104 <https://github.com/Perl/perl5/issues/23104>]
.PP
The related experimental warning flags are consequently named
\&\f(CW\*(C`experimental::keyword_any\*(C'\fR and \f(CW\*(C`experimental::keyword_all\*(C'\fR.
.SS "Apostrophe as a global name separator can be disabled"
.IX Subsection "Apostrophe as a global name separator can be disabled"
This was deprecated in Perl 5.38 and removed as scheduled in perl
5.41.3, but after some discussion has been reinstated by default.
.PP
This can be controlled with the \f(CW\*(C`apostrophe_as_package_separator\*(C'\fR
feature which is enabled by default, but is disabled from the 5.41
feature bundle onwards.
.PP
If you want to disable use within your own code you can explicitly
disable the feature:
.PP
.Vb 1
\&  no feature "apostrophe_as_package_separator";
.Ve
.PP
Note that disabling this feature only prevents use of apostrophe as a
package separator within code; symbolic references still treat \f(CW\*(C`\*(Aq\*(C'\fR as
\&\f(CW\*(C`::\*(C'\fR with the feature disabled:
.PP
.Vb 7
\&  my $symref = "My\*(AqModule\*(AqVar";
\&  # default features
\&  my $x = $My\*(AqModule\*(AqVar; # fine
\&  no feature "apostrophe_as_package_separator";
\&  no strict "refs";
\&  my $y = $$symref;       # like $My::Module::Var
\&  my $z = $My\*(AqModule\*(AqVar; # syntax error
.Ve
.PP
[GH #22644 <https://github.com/Perl/perl5/issues/22644>]
.ie n .SS "Lexical method declaration using ""my method"""
.el .SS "Lexical method declaration using \f(CWmy method\fP"
.IX Subsection "Lexical method declaration using my method"
Like \f(CW\*(C`sub\*(C'\fR since Perl version 5.18, \f(CW\*(C`method\*(C'\fR can now be prefixed with the
\&\f(CW\*(C`my\*(C'\fR keyword.  This declares a subroutine that has lexical, rather than
package visibility.  See perlclass for more detail.
.ie n .SS "Lexical method invocation operator ""\->&"""
.el .SS "Lexical method invocation operator \f(CW\->&\fP"
.IX Subsection "Lexical method invocation operator ->&"
Along with the ability to declare methods lexically, this release also permits
invoking a lexical subroutine as if it were a method, bypassing the usual
name\-based method resolution.
.PP
Combined with lexical method declaration, these two new abilities create the
effect of having private methods.
.SS "Switch and Smart Match operator kept, behind a feature"
.IX Subsection "Switch and Smart Match operator kept, behind a feature"
The "switch" feature and the smartmatch operator, \f(CW\*(C`~~\*(C'\fR, were introduced in
v5.10.  Their behavior was significantly changed in v5.10.1.  When the
"experiment" system was added in v5.18.0, switch and smartmatch were
retroactively declared experimental.  Over the years, proposals to fix or
supplement the features have come and gone.
.PP
They were deprecated in Perl v5.38.0 and scheduled for removal in
Perl v5.42.0. After extensive discussion their removal has been indefinitely
postponed. Using them no longer produces a deprecation warning.
.PP
Switch itself still requires the \f(CW\*(C`switch\*(C'\fR feature, which is enabled
by default for feature bundles from v5.9.5 through to v5.34.  Switch
remains disabled in feature bundles 5.35 and later, but can be
separately enabled:
.PP
.Vb 7
\&  # no switch here
\&  use v5.10;
\&  # switch here
\&  use v5.36;
\&  # no switch here
\&  use feature "switch";
\&  # switch here
.Ve
.PP
Smart match now requires the \f(CW\*(C`smartmatch\*(C'\fR feature, which is enabled
by default and included in all feature bundles up to 5.40.  It is
disabled for the 5.41 feature bundle and later, but can be separately
enabled:
.PP
.Vb 5
\&  # smartmatch here
\&  use v5.41;
\&  # no smartmatch here
\&  use feature "smartmatch";
\&  # smartmatch here
.Ve
.PP
[GH #22752 <https://github.com/Perl/perl5/issues/22752>]
.SS "Unicode 16.0 supported"
.IX Subsection "Unicode 16.0 supported"
Perl now supports Unicode 16.0
<https://www.unicode.org/versions/Unicode16.0.0/> including the changes
introduced in 15.1 <https://www.unicode.org/versions/Unicode15.1.0/>.
.ie n .SS "Assigning logical xor ""^^="" operator"
.el .SS "Assigning logical xor \f(CW^^=\fP operator"
.IX Subsection "Assigning logical xor ^^= operator"
Perl 5.40.0 introduced the logical medium\-precedence exclusive\-or operator
\&\f(CW\*(C`^^\*(C'\fR.  It was not noticed at the time that the assigning variant \f(CW\*(C`^^=\*(C'\fR was
also missing.  This is now added.
.SH Security
.IX Header "Security"
.SS "[CVE\-2024\-56406] Heap buffer overflow vulnerability with tr//"
.IX Subsection "[CVE-2024-56406] Heap buffer overflow vulnerability with tr//"
A heap buffer overflow vulnerability was discovered in Perl.
.PP
When there are non\-ASCII bytes in the left\-hand\-side of the \f(CW\*(C`tr\*(C'\fR operator,
\&\f(CWS_do_trans_invmap()\fR can overflow the destination pointer \f(CW\*(C`d\*(C'\fR.
.PP
.Vb 2
\&  $ perl \-e \*(Aq$_ = "\ex{FF}" x 1000000; tr/\exFF/\ex{100}/;\*(Aq
\&  Segmentation fault (core dumped)
.Ve
.PP
It is believed that this vulnerability can enable Denial of Service or
Arbitrary Code Execution attacks on platforms that lack sufficient defenses.
.PP
This problem was discovered by Nathan Mills and assigned
[CVE\-2024\-56406 <https://lists.security.metacpan.org/cve-announce/msg/28708725/>]
by the CPAN Security Group <https://security.metacpan.org/>.
.PP
The patch to fix this issue (87f42aa0e0096e9a346c9672aa3a0bd3bef8c1dd <https://github.com/Perl/perl5/commit/87f42aa0e0096e9a346c9672aa3a0bd3bef8c1dd>) is applicable to all perls that are vulnerable, including those
out\-of\-support.
.SS "[CVE\-2025\-40909] Perl threads have a working directory race condition where file operations may target unintended paths"
.IX Subsection "[CVE-2025-40909] Perl threads have a working directory race condition where file operations may target unintended paths"
Perl thread cloning had a working directory race condition where file
operations may target unintended paths. Perl 5.42 will no longer chdir
to each handle.
.PP
This problem was discovered by Vincent Lef√®vre via [GH #23010 <https://github.com/Perl/perl5/issues/23010>]
and assigned [CVE\-2025\-40909 <https://lists.security.metacpan.org/cve-announce/msg/30017499/>]
by the CPAN Security Group <https://security.metacpan.org/>.
.PP
Fixes were provided via [GH #23019 <https://github.com/Perl/perl5/pull/23019>]
and [GH #23361 <https://github.com/Perl/perl5/pull/23361>].
.SH "Incompatible Changes"
.IX Header "Incompatible Changes"
.SS "Removed containing function references for functions without eval"
.IX Subsection "Removed containing function references for functions without eval"
Perl 5.40 reintroduced unconditional references from functions to their
containing functions to fix a bug introduced in Perl 5.18 that broke the
special behaviour of \f(CW\*(C`eval EXPR\*(C'\fR in package \f(CW\*(C`DB\*(C'\fR which is used by the
debugger.
.PP
In some cases this change led to circular reference chains between closures and
other existing references, resulting in memory leaks.
.PP
This change has been reverted, fixing
[GH #22547 <https://github.com/Perl/perl5/issues/22547>] but re\-breaking
[GH #19370 <https://github.com/Perl/perl5/issues/19370>].
.PP
This means the reference loops won\*(Aqt occur, and that lexical variables and
functions from enclosing functions may not be visible in the debugger.
.PP
Note that calling \f(CW\*(C`eval EXPR\*(C'\fR in a function unconditionally causes a function
to reference its enclosing functions as it always has.
.SH "Performance Enhancements"
.IX Header "Performance Enhancements"
.IP \(bu 4
Constant\-folded strings are now shareable via the Copy\-on\-Write mechanism.
[GH #22163 <https://github.com/Perl/perl5/pull/22163>]
.Sp
The following code would previously have allocated eleven string buffers,
each containing one million "A"s:
.Sp
.Vb 1
\&    my @scalars; push @scalars, ("A" x 1_000_000) for 0..9;
.Ve
.Sp
Now a single buffer is allocated and shared between a CONST OP and
the ten scalar elements of \f(CW@scalars\fR.
.Sp
Note that any code using this sort of constant to simulate memory leaks
(perhaps in test files) must now permute the string in order to trigger
a string copy and the allocation of separate buffers. For example,
\&\f(CW\*(C`("A" x 1_000_000).time\*(C'\fR might be a suitable small change.
.IP \(bu 4
\&\f(CW\*(C`tr///\*(C'\fR now runs at the same speed regardless of the internal
representation of its operand, as long as the only characters being
translated are ASCII\-range, for example \f(CW\*(C`tr/A\-Z/a\-z/\*(C'\fR.  Previously, if
the internal encoding was UTF\-8, a slower, more general implementation
was used.
.IP \(bu 4
Code that uses the \f(CW\*(C`indexed\*(C'\fR function from the builtin module to generate
a list of index/value pairs out of an array or list which is then passed into
a two\-variable \f(CW\*(C`foreach\*(C'\fR list to unpack those again is now optimised to be
more efficient.
.Sp
.Vb 1
\&    my @array = (...);
\&
\&    foreach my ($idx, $val) (builtin::indexed @array) {
\&        ...
\&    }
.Ve
.Sp

.Sp
.Vb 3
\&    foreach my ($idx, $val) (builtin::indexed LIST...) {
\&        ...
\&    }
.Ve
.Sp
In particular, a temporary list twice the size of the original is no longer
generated.  Instead, the loop iterates down the original array or list
in\-place directly, in the same way that \f(CW\*(C`foreach (@array)\*(C'\fR or
\&\f(CW\*(C`foreach (LIST)\*(C'\fR would do.
.IP \(bu 4
The peephole optimizer recognises the following zero\-offset \f(CW\*(C`substr\*(C'\fR patterns
and swaps in a new dedicated operator (\f(CW\*(C`OP_SUBSTR_LEFT\*(C'\fR).
[GH #22785 <https://github.com/Perl/perl5/issues/22785>]
.Sp
.Vb 2
\&    substr($x, 0, ...)
\&    substr($x, 0, ..., \*(Aq\*(Aq)
.Ve
.IP \(bu 4
The stringification of integers by "print" in perlfunc and "say" in perlfunc,
when coming from an \f(CW\*(C`SVt_IV\*(C'\fR, is now more efficient.
[GH #22927 <https://github.com/Perl/perl5/issues/22927>]
.IP \(bu 4
String reversal from a single argument, when the string buffer is not
"swiped", is now done in a single pass and is noticeably faster.
The extent of the improvement is compiler & hardware dependent.
[GH #23012 <https://github.com/Perl/perl5/issues/23012>]
.SH "Modules and Pragmata"
.IX Header "Modules and Pragmata"
.SS "Updated Modules and Pragmata"
.IX Subsection "Updated Modules and Pragmata"
.IP \(bu 4
Archive::Tar has been upgraded from version 3.02_001 to 3.04.
.IP \(bu 4
B::Deparse has been upgraded from version 1.76 to 1.85.
.IP \(bu 4
Benchmark has been upgraded from version 1.25 to 1.27.
.IP \(bu 4
builtin has been upgraded from version 0.014 to 0.019.
.IP \(bu 4
Compress::Raw::Bzip2 has been upgraded from version 2.212 to 2.213.
.IP \(bu 4
Compress::Raw::Zlib has been upgraded from version 2.212 to 2.213.
.IP \(bu 4
Config::Perl::V has been upgraded from version 0.36 to 0.38.
.IP \(bu 4
CPAN has been upgraded from version 2.36 to 2.38.
.IP \(bu 4
CPAN::Meta::YAML has been upgraded from version 0.018 to 0.020.
.IP \(bu 4
Data::Dumper has been upgraded from version 2.189 to 2.192.
.IP \(bu 4
DB has been upgraded from version 1.08 to 1.09.
.IP \(bu 4
DBM_Filter has been upgraded from version 0.06 to 0.07.
.IP \(bu 4
Devel::Peek has been upgraded from version 1.34 to 1.36.
.IP \(bu 4
Devel::PPPort has been upgraded from version 3.72 to 3.73.
.IP \(bu 4
Digest::MD5 has been upgraded from version 2.58_01 to 2.59.
.IP \(bu 4
DynaLoader has been upgraded from version 1.56 to 1.57.
.IP \(bu 4
experimental has been upgraded from version 0.032 to 0.035.
.IP \(bu 4
Exporter has been upgraded from version 5.78 to 5.79.
.IP \(bu 4
ExtUtils::CBuilder has been upgraded from version 0.280240 to 0.280242.
.IP \(bu 4
ExtUtils::MakeMaker has been upgraded from version 7.70 to 7.76.
.IP \(bu 4
ExtUtils::ParseXS has been upgraded from version 3.51 to 3.57.
.IP \(bu 4
ExtUtils::Typemaps has been upgraded from version 3.51 to 3.57.
.IP \(bu 4
Fcntl has been upgraded from version 1.18 to 1.20.
.IP \(bu 4
feature has been upgraded from version 1.89 to 1.97.
.IP \(bu 4
fields has been upgraded from version 2.25 to 2.27.
.IP \(bu 4
File::Spec has been upgraded from version 3.90 to 3.94.
.IP \(bu 4
Getopt::Long has been upgraded from version 2.57 to 2.58.
.IP \(bu 4
HTTP::Tiny has been upgraded from version 0.088 to 0.090.
.IP \(bu 4
IO::Compress has been upgraded from version 2.212 to 2.213.
.IP \(bu 4
IO::Socket::IP has been upgraded from version 0.42 to 0.43.
.IP \(bu 4
IPC::Open3 has been upgraded from version 1.22 to 1.24.
.IP \(bu 4
locale has been upgraded from version 1.12 to 1.13.
.IP \(bu 4
Math::BigInt has been upgraded from version 2.003002 to 2.005002.
.IP \(bu 4
Math::BigInt::FastCalc has been upgraded from version 0.5018 to 0.5020.
.IP \(bu 4
Math::Complex has been upgraded from version 1.62 to 1.63.
.IP \(bu 4
Memoize has been upgraded from version 1.16 to 1.17.
.IP \(bu 4
Module::CoreList has been upgraded from version 5.20240609 to 5.20250702.
.IP \(bu 4
NDBM_File has been upgraded from version 1.17 to 1.18.
.IP \(bu 4
ODBM_File has been upgraded from version 1.18 to 1.20.
.IP \(bu 4
Opcode has been upgraded from version 1.65 to 1.69.
.IP \(bu 4
overload has been upgraded from version 1.37 to 1.40.
.IP \(bu 4
parent has been upgraded from version 0.241 to 0.244.
.IP \(bu 4
perlfaq has been upgraded from version 5.20240218 to 5.20250619.
.IP \(bu 4
Pod::Usage has been upgraded from version 2.03 to 2.05.
.IP \(bu 4
podlators has been upgraded from version 5.01_02 to v6.0.2.
.IP \(bu 4
POSIX has been upgraded from version 2.20 to 2.23.
.IP \(bu 4
re has been upgraded from version 0.47 to 0.48.
.IP \(bu 4
Safe has been upgraded from version 2.46 to 2.47.
.IP \(bu 4
Scalar::Util has been upgraded from version 1.63 to 1.68_01.
.IP \(bu 4
Search::Dict has been upgraded from version 1.07 to 1.08.
.IP \(bu 4
SelfLoader has been upgraded from version 1.27 to 1.28.
.IP \(bu 4
sort has been upgraded from version 2.05 to 2.06.
.IP \(bu 4
Storable has been upgraded from version 3.32 to 3.37.
.IP \(bu 4
strict has been upgraded from version 1.13 to 1.14.
.IP \(bu 4
Term::Table has been upgraded from version 0.018 to 0.024.
.IP \(bu 4
Test::Harness has been upgraded from version 3.48 to 3.50.
.IP \(bu 4
Test::Simple has been upgraded from version 1.302199 to 1.302210.
.IP \(bu 4
Thread has been upgraded from version 3.05 to 3.06.
.IP \(bu 4
threads has been upgraded from version 2.40 to 2.43.
.IP \(bu 4
threads::shared has been upgraded from version 1.69 to 1.70.
.IP \(bu 4
Tie::File has been upgraded from version 1.09 to 1.10.
.IP \(bu 4
Tie::RefHash has been upgraded from version 1.40 to 1.41.
.IP \(bu 4
Time::HiRes has been upgraded from version 1.9777 to 1.9778.
.IP \(bu 4
Time::Piece has been upgraded from version 1.3401_01 to 1.36.
.IP \(bu 4
Unicode::UCD has been upgraded from version 0.78 to 0.81.
.IP \(bu 4
utf8 has been upgraded from version 1.25 to 1.27.
.IP \(bu 4
version has been upgraded from version 0.9930 to 0.9933.
.IP \(bu 4
VMS::Filespec has been upgraded from version 1.13 to 1.15.
.IP \(bu 4
warnings has been upgraded from version 1.69 to 1.74.
.IP \(bu 4
Win32 has been upgraded from version 0.59 to 0.59_01.
.IP \(bu 4
XS::APItest has been upgraded from version 1.36 to 1.43.
.SH Documentation
.IX Header "Documentation"
.SS "Changes to Existing Documentation"
.IX Subsection "Changes to Existing Documentation"
We have attempted to update the documentation to reflect the changes
listed in this document. If you find any we have missed, open an issue
at <https://github.com/Perl/perl5/issues>.
.PP
Additionally, the following selected changes have been made:
.PP
\fIperlapi\fR
.IX Subsection "perlapi"
.IP \(bu 4
Combined the documentation for several groups of related functions
into single entries.
.IP \(bu 4
All forms of \f(CWgv_fetchmeth()\fR are now documented together.
.IP \(bu 4
\&\f(CW\*(C`gv_autoload4\*(C'\fR is now documented with \f(CW\*(C`gv_autoload_pv\*(C'\fR and additional notes added.
The long \f(CW\*(C`Perl_\*(C'\fR forms are now listed when available.
.PP
\fIperldata\fR
.IX Subsection "perldata"
.IP \(bu 4
Binary and octal floating\-point constants (such as \f(CW\*(C`012.345p\-2\*(C'\fR and
\&\f(CW\*(C`0b101.11p\-1\*(C'\fR) are now documented. This feature was first introduced in perl
5.22.0 together with hexadecimal floating\-point constants and had a few bug
fixes in perl 5.28.0, but it was never formally documented.
[GH #18664 <https://github.com/Perl/perl5/issues/18664>]
.PP
\fIperlfunc\fR
.IX Subsection "perlfunc"
.IP \(bu 4
Clarified the description of \f(CW\*(C`ref\*(C'\fR and \f(CW\*(C`reftype\*(C'\fR in relation
to built\-in types and class names.
.IP \(bu 4
Clarified that perl \f(CW\*(C`sort\*(C'\fR is stable (and has been since v5.8.0).
.IP \(bu 4
The recommended alternatives to the \f(CWrand()\fR function were updated to modern modules
recommended by the CPAN Security Group <https://security.metacpan.org/>.
[GH #22873 <https://github.com/Perl/perl5/pull/22873>]
.PP
\fIperlgov\fR
.IX Subsection "perlgov"
.IP \(bu 4
The list of Steering Council and Core Team members have been updated, following the conclusion of
the latest election on 2024\-07\-17.
.PP
\fIperlguts\fR
.IX Subsection "perlguts"
.IP \(bu 4
Added some description of "real" \f(CW\*(C`AV\*(C'\fRs compared to "fake" \f(CW\*(C`AV\*(C'\fRs.
.IP \(bu 4
Documentation was updated to reflect that mixing \f(CW\*(C`Newx\*(C'\fR, \f(CW\*(C`Renew\*(C'\fR, and
\&\f(CW\*(C`Safefree\*(C'\fR vs \f(CW\*(C`malloc\*(C'\fR, \f(CW\*(C`realloc\*(C'\fR, and \f(CW\*(C`free\*(C'\fR are not allowed, and mixing
pointers between the 2 classes of APIs is not allowed. Updates made in
perlguts and perlclib.
.IP \(bu 4
Additional caveats have been added to the description of \f(CW\*(C`TARG\*(C'\fR.
.PP
\fIperlop\fR
.IX Subsection "perlop"
.IP \(bu 4
Portions of perlop are supposed to be ordered so that all the operators
wth the same precedence are in a single section, and the sections are
ordered so that the highest precedence operators appear first.
This ordering has now been restored.  Other reorganization was done to
improve clarity, with more basic operations described before ones that
depend on them.
.IP \(bu 4
The documentation for here\-docs has been cleaned up and reorganized.
Indented here\-docs were formerly documented separately, now the two
types have interwoven documentation which is more compact, and easier to
understand.
.IP \(bu 4
The documentation of the \f(CW\*(C`xor\*(C'\fR operator has been expanded.
.IP \(bu 4
Outdated advice about using relational string operators in UTF\-8 locales
has been removed.  Use Unicode::Collate for the best results, but
these operators will give adequate results on many platforms.
.IP \(bu 4
Normalized alignment of verbatim sections, fixing how they are displayed by
some Pod viewers that strip indentation.
.PP
\fIperlvar\fR
.IX Subsection "perlvar"
.IP \(bu 4
Entries for \f(CW$#\fR and \f(CW$*\fR have been amended to note that use of them result in a compilation
error, not a warning.
.SH Diagnostics
.IX Header "Diagnostics"
The following additions or changes have been made to diagnostic output,
including warnings and fatal error messages. For the complete list of
diagnostic messages, see perldiag.
.SS "New Diagnostics"
.IX Subsection "New Diagnostics"
\fINew Errors\fR
.IX Subsection "New Errors"
.IP \(bu 4
Use of non\-ASCII character 0x%X illegal when \*(Aquse source::encoding "ascii"\*(Aq is in effect
.Sp
(F) This pragma forbids non\-ASCII characters within its scope.
.IP \(bu 4
Undefined subroutine &%s called, close to label \*(Aq%s\*(Aq
.Sp
(F) The subroutine indicated hasn\*(Aqt been defined, or if it was, it has
since been undefined.
.Sp
This error could also indicate a mistyped package separator, when a
single colon was typed instead of two colons. For example, \f(CWFoo:bar()\fR
would be parsed as the label \f(CW\*(C`Foo\*(C'\fR followed by an unqualified function
name: \f(CW\*(C`foo: bar()\*(C'\fR. [GH #22860 <https://github.com/Perl/perl5/issues/22860>]
.PP
\fINew Warnings\fR
.IX Subsection "New Warnings"
.IP \(bu 4
_\|_CLASS_\|_ is experimental
.Sp
(S experimental::class) This warning is emitted if you use the \f(CW\*(C`_\|_CLASS_\|_\*(C'\fR
keyword of \f(CW\*(C`use feature \*(Aqclass\*(Aq\*(C'\fR. This keyword is currently
experimental and its behaviour may change in future releases of Perl.
.IP \(bu 4
%s() attempted on handle \f(CW%s\fR opened with \fBopen()\fR
.Sp
(W io) You called \fBreaddir()\fR, \fBtelldir()\fR, \fBseekdir()\fR, \fBrewinddir()\fR or
\&\fBclosedir()\fR on a handle that was opened with \fBopen()\fR.  If you want to
use these functions to traverse the contents of a directory, you need
to open the handle with \fBopendir()\fR.
.Sp
[GH #22394 <https://github.com/Perl/perl5/issues/22394>]
.IP \(bu 4
Possible precedence problem between ! and \f(CW%s\fR
.Sp
(W precedence) You wrote something like
.Sp
.Vb 4
\&    !$x < $y               # parsed as: (!$x) < $y
\&    !$x eq $y              # parsed as: (!$x) eq $y
\&    !$x =~ /regex/         # parsed as: (!$x) =~ /regex/
\&    !$obj isa Some::Class  # parsed as: (!$obj) isa Some::Class
.Ve
.Sp
but because \f(CW\*(C`!\*(C'\fR has higher precedence than comparison operators, \f(CW\*(C`=~\*(C'\fR, and
\&\f(CW\*(C`isa\*(C'\fR, this is interpreted as comparing/matching the logical negation of the
first operand, instead of negating the result of the comparison/match.
.Sp
To disambiguate, either use a negated comparison/binding operator:
.Sp
.Vb 3
\&    $x >= $y
\&    $x ne $y
\&    $x !~ /regex/
.Ve
.Sp
\&... or parentheses:
.Sp
.Vb 4
\&    !($x < $y)
\&    !($x eq $y)
\&    !($x =~ /regex/)
\&    !($obj isa Some::Class)
.Ve
.Sp
\&... or the low\-precedence \f(CW\*(C`not\*(C'\fR operator:
.Sp
.Vb 4
\&    not $x < $y
\&    not $x eq $y
\&    not $x =~ /regex/
\&    not $obj isa Some::Class
.Ve
.Sp
(If you did mean to compare the boolean result of negating the first operand,
parenthesize as \f(CW\*(C`(!$x) < $y\*(C'\fR, \f(CW\*(C`(!$x) eq $y\*(C'\fR, etc.)
.Sp
Note: this warning does not trigger for code like \f(CW\*(C`!!$x == $y\*(C'\fR,
i.e. where double negation (\f(CW\*(C`!!\*(C'\fR) is used as a convert\-to\-boolean operator.
.SS "Changes to Existing Diagnostics"
.IX Subsection "Changes to Existing Diagnostics"
.IP \(bu 4
%s() attempted on invalid dirhandle \f(CW%s\fR
.Sp
This was consolidated from separate messages for \fBreaddir()\fR, \fBtelldir()\fR,
\&\fBseekdir()\fR, \fBrewinddir()\fR and \fBclosedir()\fR as part of refactoring for
[GH #22394 <https://github.com/Perl/perl5/issues/22394>].
.IP \(bu 4
Useless use of \f(CW%s\fR in void context
.Sp
This warning now triggers for use of a chained comparison like \f(CW\*(C`0 < $x < 1\*(C'\fR.
[GH #22969 <https://github.com/Perl/perl5/issues/22969>]
.IP \(bu 4
Use of uninitialized value%s
.Sp
Prevent this warning when accessing a function parameter in \f(CW@_\fR that
is an lvalue reference to an untied hash element where the key was
undefined.  This warning is still produced at the point of call.
[GH #22423 <https://github.com/Perl/perl5/issues/22423>]
.SH "Utility Changes"
.IX Header "Utility Changes"
.SS \fIPorting/test\-dist\-modules.pl\fP
.IX Subsection "Porting/test-dist-modules.pl"
.IP \(bu 4
Separate installation (without overwriting installed modules) is now the default.
.IP \(bu 4
Documentation is significantly enhanced.
.SH "Configuration and Compilation"
.IX Header "Configuration and Compilation"
.IP \(bu 4
Fix compilation on platforms (e.g. "Gentoo Prefix") with only a C locale [GH #22569 <https://github.com/Perl/perl5/issues/22569>]
Bug first reported downstream bugs.gentoo.org/939014 <https://bugs.gentoo.org/939014>
.IP \(bu 4
The (mostly undocumented) configuration macro \f(CW\*(C`PERL_STRICT_CR\*(C'\fR has been
removed. When enabled (e.g. with \f(CW\*(C`./Configure \-A ccflags=\-DPERL_STRICT_CR\*(C'\fR),
it would make the perl parser throw a fatal error when it encountered a CR
(carriage return) character in source files. The default (and now only)
behavior of the perl parser is to strip CRs paired with newline characters and
otherwise treat them as whitespace.
.Sp
(\f(CW\*(C`PERL_STRICT_CR\*(C'\fR was originally introduced in perl 5.005 to optionally
restore backward compatibility with perl 5.004, which had made CR in source
files an error. Before that, CR was accepted, but retained literally in quoted
multi\-line constructs such as here\-documents, even at the end of a line.)
.IP \(bu 4
Similarly, the (even less documented) configuration macro \f(CW\*(C`PERL_CR_FILTER\*(C'\fR has
been removed. When enabled, it would install a default source filter to strip
carriage returns from source code before the parser proper got to see it.
.SH Testing
.IX Header "Testing"
Tests were added and changed to reflect the other additions and
changes in this release.  Furthermore, these significant changes were
made:
.IP \(bu 4
A new \fIt/run/todo.t\fR test script was added as a place for TODO tests
for known unfixed bugs. Patches are welcome to add to this file.
.IP \(bu 4
Added testing of the perl headers against the C++ compiler
corresponding to the C compiler perl is being built with.
[GH #22232 <https://github.com/Perl/perl5/issues/22232>]
.SH "Platform Support"
.IX Header "Platform Support"
.SS "Platform\-Specific Notes"
.IX Subsection "Platform-Specific Notes"
.IP "arm64 Darwin" 4
.IX Item "arm64 Darwin"
Fix arm64 darwin hints when using use64bitall with Configure [GH #22672 <https://github.com/Perl/perl5/issues/22672>]
.IP Android 4
.IX Item "Android"
Changes to \fIperl_langinfo.h\fR for Android [GH #22650 <https://github.com/Perl/perl5/issues/22650>] related to [GH #22627 <https://github.com/Perl/perl5/issues/22627>].
.IP Cygwin 4
.IX Item "Cygwin"
\&\fIcygwin.c\fR: fix several silly/terrible C errors. [GH #22724 <https://github.com/Perl/perl5/issues/22724>]
.Sp
Supply an explicit base address for \f(CW\*(C`cygperl*.dll\*(C'\fR that cannot
conflict with those generated by \f(CW\*(C`\-\-enable\-auto\-image\-base\*(C'\fR.  [GH #22695 <https://github.com/Perl/perl5/issues/22695>][GH #22104 <https://github.com/Perl/perl5/issues/22104>]
.IP "MacOS (Darwin)" 4
.IX Item "MacOS (Darwin)"
Collation of strings using locales on MacOS 15 (Darwin 24) and up has
been turned off due to a failed assertion in its libc.
.Sp
If earlier versions are also experiencing issues (such as failures in
\&\fIlocale.t\fR), you can explicitly disable locale collation by adding the
\&\f(CW\*(C`\-Accflags=\-DNO_LOCALE_COLLATE\*(C'\fR option to your invocation of \f(CW\*(C`./Configure\*(C'\fR,
or just \f(CW\*(C`\-DNO_LOCALE_COLLATE\*(C'\fR to the \f(CW\*(C`ccflags\*(C'\fR and \f(CW\*(C`cppflags\*(C'\fR
variables in \fIconfig.sh\fR.
.SH "Internal Changes"
.IX Header "Internal Changes"
.IP \(bu 4
The "\f(CW\*(C`sv_strftime_ints\*(C'\fR" in perlapi function is introduced.  This is an
enhanced version of "\f(CW\*(C`my_strftime\*(C'\fR" in perlapi, which is retained for
backwards compatibility.  Both are to call \fBstrftime\fR\|(3) when you have
the year, month, hour, etc.  The new function handles UTF8ness for you,
and allows you to specify if you want the possibility of daylight
savings time to be considered.  \f(CW\*(C`my_strftime\*(C'\fR never considers DST.
.IP \(bu 4
The \f(CW\*(C`bytes_to_utf8\*(C'\fR, \f(CW\*(C`bytes_from_utf8\*(C'\fR, and \f(CW\*(C`bytes_from_utf8_loc\*(C'\fR
functions are no longer experimental.
.IP \(bu 4
Calls to \fBcall_argv()\fR with the \f(CW\*(C`G_DISCARD\*(C'\fR flag
set also ensure the SV parameters constructed from the \f(CW\*(C`argv\*(C'\fR
parameter are released before \f(CWcall_argv()\fR returns. Previously they
were released on the next FREETMPS. [GH #22255 <https://github.com/Perl/perl5/issues/22255>]
.IP \(bu 4
When built with the \f(CW\*(C`\-DDEBUGGING\*(C'\fR compile option, perl API functions that
take pointers to distinct types of SVs (AVs, HVs or CVs) will check the
\&\f(CWSvTYPE()\fR of the passed values to ensure they are valid.  Additionally,
internal code within core functions that attempts to extract AVs, HVs or CVs
from reference values passed in will also perform such checks.
.Sp
While this has been entirely tested by normal Perl CI testing, there may
still be some corner\-cases where these constraints are violated in
otherwise\-valid calls.  These may require further investigation if they are
found, and specific code to be adjusted to account for it.
.IP \(bu 4
The \f(CWop_dump()\fR function has been expanded to include additional information
about the recent \f(CW\*(C`OP_METHSTART\*(C'\fR and \f(CW\*(C`OP_INITFIELD\*(C'\fR ops, as well as for
\&\f(CW\*(C`OP_ARGCHECK\*(C'\fR and \f(CW\*(C`OP_ARGELEM\*(C'\fR which had not been done previously.
.IP \(bu 4
\&\f(CWop_dump()\fR now also has the facility to print extra debugging information
about custom operators, if those operators register a helper function via the
new \f(CW\*(C`xop_dump\*(C'\fR element of the \f(CW\*(C`XOP\*(C'\fR structure. For more information, see the
relevant additions to perlguts.
.IP \(bu 4
New API functions are introduced to convert strings encoded in UTF\-8 to
their ordinal code point equivalent.  These are safe to use by default,
and generally more convenient to use than the existing ones.
.Sp
"\f(CW\*(C`utf8_to_uv\*(C'\fR" in perlapi and "\f(CW\*(C`utf8_to_uv_or_die\*(C'\fR" in perlapi replace
"\f(CW\*(C`utf8_to_uvchr\*(C'\fR" in perlapi (which is retained for backwards
compatibility), but you should convert to use the new forms, as likely
you aren\*(Aqt using the old one safely.
.Sp
To convert in the opposite direction, you can now use
"\f(CW\*(C`uv_to_utf8\*(C'\fR" in perlapi.  This is not a new function, but a new synonym
for "\f(CW\*(C`uvchr_to_utf8\*(C'\fR" in perlapi.  It is added so you don\*(Aqt have to learn
two sets of names.
.Sp
There are also two new functions, "\f(CW\*(C`strict_utf8_to_uv\*(C'\fR" in perlapi and
"\f(CW\*(C`c9strict_utf8_to_uv\*(C'\fR" in perlapi which do the same thing except when
the input string represents a code point that Unicode doesn\*(Aqt accept as
legal for interchange, using either the strict original definition
(\f(CW\*(C`strict_utf8_to_uv\*(C'\fR), or the looser one given by
Unicode Corrigendum #9 <https://www.unicode.org/versions/corrigendum9.html>
(\f(CW\*(C`c9strict_utf8_to_uv\*(C'\fR).  When the input string represents one of the
restricted code points, these functions return the Unicode
\&\f(CW\*(C`REPLACEMENT CHARACTER\*(C'\fR instead.
.Sp
Also "\f(CW\*(C`extended_utf8_to_uv\*(C'\fR" in perlapi is a synonym for \f(CW\*(C`utf8_to_uv\*(C'\fR, for use
when you want to emphasize that the entire range of Perl extended UTF\-8
is acceptable.
.Sp
There are also replacement functions for the three more specialized
conversion functions that you are unlikely to need to use.  Again, the
old forms are kept for backwards compatibility, but you should convert
to use the new forms.
.Sp
"\f(CW\*(C`utf8_to_uv_flags\*(C'\fR" in perlapi replaces "\f(CW\*(C`utf8n_to_uvchr\*(C'\fR" in perlapi.
.Sp
"\f(CW\*(C`utf8_to_uv_errors\*(C'\fR" in perlapi replaces "\f(CW\*(C`utf8n_to_uvchr_error\*(C'\fR" in perlapi.
.Sp
"\f(CW\*(C`utf8_to_uv_msgs\*(C'\fR" in perlapi replaces
"\f(CW\*(C`utf8n_to_uvchr_msgs\*(C'\fR" in perlapi.
.Sp
Also added are the inverse functions "\f(CW\*(C`uv_to_utf8_flags\*(C'\fR" in perlapi
and "\f(CW\*(C`uv_to_utf8_msgs\*(C'\fR" in perlapi, which are synonyms for the existing
functions, "\f(CW\*(C`uvchr_to_utf8_flags\*(C'\fR" in perlapi and
"\f(CW\*(C`uvchr_to_utf8_flags_msgs\*(C'\fR" in perlapi respectively.  These are provided only
so you don\*(Aqt have to learn two sets of names.
.IP \(bu 4
Three new API functions are introduced to convert strings encoded in
UTF\-8 to native bytes format (if possible).  These are easier to use
than the existing ones, and they avoid unnecessary memory allocations.
The functions are "\f(CW\*(C`utf8_to_bytes_overwrite\*(C'\fR" in perlapi which is used
when it is ok for the input string to be overwritten with the converted
result; and "\f(CW\*(C`utf8_to_bytes_new_pv\*(C'\fR" in perlapi and
"\f(CW\*(C`utf8_to_bytes_temp_pv\*(C'\fR" in perlapi when the original string must be
preserved intact.  \f(CW\*(C`utf8_to_bytes_temp_pv\*(C'\fR returns the result in a
temporary using perlapi/\f(CW\*(C`SAVEFREEPV\*(C'\fR that will automatically be
destroyed.  With \f(CW\*(C`utf8_to_bytes_new_pv\*(C'\fR, you are responsible for
freeing the newly allocated memory that is returned if the conversion is
successful.
.Sp
The latter two functions are designed to replace
"\f(CW\*(C`bytes_from_utf8\*(C'\fR" in perlapi which creates memory unnecessarily, or
unnecessarily large.
.IP \(bu 4
New API functions \f(CWvalid_identifier_pve()\fR,
\&\f(CWvalid_identifier_pvn()\fR and
\&\f(CWvalid_identifier_sv()\fR have been added, which
test if a string would be considered by Perl to be a valid identifier name.
.IP \(bu 4
When assigning from an SVt_IV into a SVt_NV (or vice versa), providing that
both are "bodyless" types, Perl_sv_setsv_flags will now just change the
destination type to match the source type. Previously, an SVt_IV would have
been upgraded to a SVt_PVNV to store an NV, and an SVt_NV would have been
upgraded to a SVt_PVIV to store an IV. This change prevents the need to
allocate \- and later free \- the relevant body struct.
.IP \(bu 4
Two new API functions are introduced to convert strings encoded in
native bytes format to UTF\-8.  These return the string unchanged if its
UTF\-8 representation is the same as the original.  Otherwise, new memory
is allocated to contain the converted string.  This is in contrast to
the existing "\f(CW\*(C`bytes_to_utf8\*(C'\fR" in perlapi which always allocates new
memory.  The new functions are "\f(CW\*(C`bytes_to_utf8_free_me\*(C'\fR" in perlapi and
"\f(CW\*(C`bytes_to_utf8_temp_pv\*(C'\fR" in perlapi.
"\f(CW\*(C`bytes_to_utf8_temp_pv\*(C'\fR" in perlapi arranges for the new memory to
automatically be freed.  With \f(CW\*(C`bytes_to_utf8_free_me\*(C'\fR, you are
responsible for freeing any newly allocated memory.
.IP \(bu 4
The way that subroutine signatures are parsed by the parser grammar has been
changed.
.Sp
Previously, when parsing individual signature parameters, the parser would
accumulate an \f(CW\*(C`OP_ARGELEM\*(C'\fR optree fragment for each parameter on the parser
stack, collecting them in an \f(CW\*(C`OP_LIST\*(C'\fR sequence, before finally building the
complete argument handling optree itself, in a large action block defined
directly in \fIperly.y\fR.
.Sp
In the new approach, all the optree generation is handled by newly\-defined
functions in \fIop.c\fR which are called by the action blocks in the parser.
These do not keep state on the parser stack, but instead in a dedicated memory
structure referenced by the main \f(CW\*(C`PL_parser\*(C'\fR structure.  This is intended to
be largely opaque to other code, and accessed only via the new functions.
.Sp
This new arrangement is intended to allow more flexible code generation and
additional features to be developed in the future.
.IP \(bu 4
Three new API functions have been added to interact with the regexp global
match position stored in an SV.  These are \f(CWsv_regex_global_pos_get()\fR,
\&\f(CWsv_regex_global_pos_set()\fR and \f(CWsv_regex_global_pos_clear()\fR.  Using these
API functions avoids XS modules needing to know about or interact directly
with the way this position is currently stored, which involves the
\&\f(CW\*(C`PERL_MAGIC_regex_global\*(C'\fR magic type.
.IP \(bu 4
New \f(CW\*(C`SvVSTRING\*(C'\fR API macro
.Sp
A new API macro has been added, which is used to obtain the second string
buffer out of a "vstring" SV, in a manner similar to the \f(CW\*(C`SvPV\*(C'\fR macro which
obtains the regular string buffer out of a regular SV.
.Sp
.Vb 2
\&    STRLEN len;
\&    const char *vstr_pv = SvVSTRING(sv, vstr_len);
.Ve
.Sp
See "\f(CW\*(C`SvVSTRING\*(C'\fR" in perlapi.
.SH "Selected Bug Fixes"
.IX Header "Selected Bug Fixes"
.IP \(bu 4
Fix null pointer dereference in S_SvREFCNT_dec [GH #16627 <https://github.com/Perl/perl5/issues/16627>].
.IP \(bu 4
Fix feature \*(Aqclass\*(Aq Segmentation fault in DESTROY [GH #22278 <https://github.com/Perl/perl5/issues/22278>].
.IP \(bu 4
\&\f(CW\*(C`chdir\*(C'\fR now returns real booleans (as its documentation describes), not
integers. This means the result of a failed \f(CW\*(C`chdir\*(C'\fR now stringifies to \f(CW\*(Aq\*(Aq\fR,
not \f(CW\*(Aq0\*(Aq\fR.
.Sp
[GH #22365 <https://github.com/Perl/perl5/issues/22365>]
.IP \(bu 4
Compound assignment operators return lvalues that can be further modified:
.Sp
.Vb 4
\&    ($x &= $y) += $z;
\&    # Equivalent to:
\&    #  $x &= $y;
\&    #  $x += $z;
.Ve
.Sp
However, the separate numeric/string bitwise operators provided by the
\&\f(CW\*(C`bitwise\*(C'\fR feature, \f(CW\*(C`&= ^= |= &.= ^.= |.=\*(C'\fR,
did not return such lvalues:
.Sp
.Vb 4
\&    use feature qw(bitwise);
\&    ($x &= $y) += $z;
\&    # Used to die:
\&    #  Can\*(Aqt modify numeric bitwise and (&) in addition (+) at ...
.Ve
.Sp
This has been corrected. [GH #22412 <https://github.com/Perl/perl5/issues/22412>]
.IP \(bu 4
Starting in v5.39.8, "\f(CW\*(C`strftime\*(C'\fR" in POSIX would crash or produce odd errors
(such as \f(CW\*(C`Out of memory in perl:util:safesysmalloc\*(C'\fR) when given a format
string that wasn\*(Aqt actually a string, but a number, \f(CW\*(C`undef\*(C'\fR, or an object
(even one with overloaded string conversion).
.Sp
Now \f(CW\*(C`strftime\*(C'\fR stringifies its first argument, as before.
[GH #22498 <https://github.com/Perl/perl5/issues/22498>]
.Sp
Also, fix \f(CWPOSIX::strftime()\fR [GH #22369 <https://github.com/Perl/perl5/issues/22369>].
.IP \(bu 4
\&\f(CW\*(C`pack("p", ...)\*(C'\fR and \f(CW\*(C`pack("P", ...)\*(C'\fR now \fBSvPV_force()\fR the supplied
SV unless it is read only.  This will remove CoW from the SV and
prevents code that writes through the generated pointer from modifying
the value of other SVs that happen the share the same CoWed string
buffer.
.Sp
Note: this does not make \f(CW\*(C`pack("p",... )\*(C'\fR safe, if the SV is magical
then any writes to the buffer will likely be discarded on the next
read.  [GH #22380 <https://github.com/Perl/perl5/issues/22380>]
.IP \(bu 4
Enforce \f(CW\*(C`no feature "bareword_filehandles"\*(C'\fR for bareword file handles
that have strictness removed because they are used in \fBopen()\fR with a
"dup" mode, such as in \f(CW\*(C`open my $fh, ">&", THISHANDLE\*(C'\fR. [GH #22568 <https://github.com/Perl/perl5/issues/22568>]
.IP \(bu 4
Using \f(CW\*(C`goto\*(C'\fR to tail call, or using the \fBcall_sv()\fR and related APIs to
call, any of \fBtrim()\fR, \fBrefaddr()\fR, \fBreftype()\fR, \fBceil()\fR, \fBfloor()\fR or
\&\fBstringify()\fR in the \f(CW\*(C`builtin::\*(C'\fR package would crash or assert due to a
\&\f(CW\*(C`TARG\*(C'\fR handling bug. [GH #22542 <https://github.com/Perl/perl5/issues/22542>]
.IP \(bu 4
Fix \fBsv_gets()\fR to accept a \f(CW\*(C`SSize_t\*(C'\fR append offset instead of \f(CW\*(C`I32\*(C'\fR.
This prevents integer overflows when appending to a large \f(CW\*(C`SV\*(C'\fR for
\&\f(CW\*(C`readpipe\*(C'\fR aka \f(CW\*(C`qx//\*(C'\fR and \f(CW\*(C`readline\*(C'\fR.
<https://www.perlmonks.org/?node_id=11161665>
.IP \(bu 4
Fixed an issue where \f(CW\*(C`utf8n_to_uvchr\*(C'\fR failed to correctly identify
certain invalid UTF\-8 sequences as invalid. Specifically, sequences
that start with continuation bytes or unassigned bytes could cause
unexpected behavior or a panic. This fix ensures that such invalid
sequences are now properly detected and handled. This correction
also resolves related issues in modules that handle UTF\-8 processing,
such as \f(CW\*(C`Encode.pm\*(C'\fR.
.IP \(bu 4
The perl parser would erroneously parse some POD directives
as if they were \f(CW\*(C`=cut\*(C'\fR. Some other POD directives
whose names start with \fIcut\fR, prematurely terminating an embedded POD section.
The following cases were affected: \fIcut\fR followed by a digit (e.g.
\&\f(CW\*(C`=cut2studio\*(C'\fR), \fIcut\fR followed by an underscore (e.g. \f(CW\*(C`=cut_grass\*(C'\fR), and in
string \f(CW\*(C`eval\*(C'\fR, any identifier starting with \fIcut\fR (e.g. \f(CW\*(C`=cute\*(C'\fR).
[GH #22759 <https://github.com/Perl/perl5/issues/22759>]
.IP \(bu 4
Builds with \f(CW\*(C`\-msse\*(C'\fR and quadmath on 32\-bit x86 systems would crash
with a misaligned access early in the build. [GH #22577 <https://github.com/Perl/perl5/issues/22577>]
.IP \(bu 4
On threaded builds on POSIX\-like systems, if the perl signal handler
receives a signal, we now resend the signal to the main perl thread.  Previously
this would crash.  [GH #22487 <https://github.com/Perl/perl5/issues/22487>]
.IP \(bu 4
Declaring a lexically scoped array or hash using \f(CW\*(C`state\*(C'\fR within a subroutine
and then immediately returning no longer triggers a "Bizarre copy of HASH/ARRAY
in subroutine exit" error. [GH #18630 <https://github.com/Perl/perl5/issues/18630>]
.IP \(bu 4
\&\f(CWbuiltin::trim()\fR didn\*(Aqt properly clear \f(CW\*(C`TARG\*(C'\fR which could result in
out of date cached numeric versions of the value being used on a
second evaluation.  Properly clear any cached values. [GH #22784 <https://github.com/Perl/perl5/issues/22784>]
.IP \(bu 4
"shmread" in perlfunc and "shmwrite" in perlfunc are no longer limited to 31\-bit
values and can use all the available bits on a platform for their POS and
SIZE arguments.
[GH #22895 <https://github.com/Perl/perl5/issues/22895>]
.IP \(bu 4
"shmread" in perlfunc is now better behaved if VAR is not a plain string.  If VAR
is a tied variable, it calls \f(CW\*(C`STORE\*(C'\fR once; previously, it would also call
\&\f(CW\*(C`FETCH\*(C'\fR, but without using the result.  If VAR is a reference, the referenced
entity has its refcount properly decremented when VAR is turned into a string;
previously, it would leak memory.
[GH #22898 <https://github.com/Perl/perl5/issues/22898>]
.IP \(bu 4
The \f(CW$SIG{_\|_DIE_\|_}\fR and \f(CW$SIG{_\|_WARN_\|_}\fR handlers can no longer be invoked
recursively, either deliberately or by accident, as described in
"%SIG" in perlvar. That is, when an exception (or warning) triggers a call to a
\&\f(CW$SIG{_\|_DIE_\|_}\fR (or \f(CW$SIG{_\|_WARN_\|_}\fR) handler, further exceptions (or
warnings) are processed directly, ignoring \f(CW%SIG\fR until the original
\&\f(CW$SIG{_\|_DIE_\|_}\fR (or \f(CW$SIG{_\|_WARN_\|_}\fR) handler call returns.
[GH #14527 <https://github.com/Perl/perl5/issues/14527>], [GH #22984 <https://github.com/Perl/perl5/issues/22984>], [GH #22987 <https://github.com/Perl/perl5/issues/22987>]
.IP \(bu 4
The \f(CWObjectFIELDS()\fR for an object and \f(CW\*(C`xhv_class_fields\*(C'\fR for the
object\*(Aqs stash weren\*(Aqt always NULL or not\-NULL, confusing \f(CWsv_dump()\fR
(and hence Devel::Peek\*(Aqs \f(CWDump()\fR) into crashing on an object with no
defined fields in some cases.  [GH #22959 <https://github.com/Perl/perl5/issues/22959>]
.IP \(bu 4
When comparing strings when using a UTF\-8 locale, the behavior was
previously undefined if either or both contained an above\-Unicode code
point, such as 0x110000.  Now all such code points will collate the same
as the highest Unicode code point, U+10FFFF. [GH #22989 <https://github.com/Perl/perl5/issues/22989>]
.IP \(bu 4
In regexes, the contents of \f(CW\*(C`\eg{...}\*(C'\fR backreferences are now properly
validated. Previously, \f(CW\*(C`\eg{1 FOO}\*(C'\fR was silently parsed as \f(CW\*(C`\eg{1}\*(C'\fR, ignoring
everything after the first number.
[GH #23050 <https://github.com/Perl/perl5/issues/23050>]
.IP \(bu 4
A run\-time pattern which contained a code block which recursed back to the
same bit of code which ran that match, could cause a crash.
[GH #22869 <https://github.com/Perl/perl5/issues/22869>]
.Sp
For example:
.Sp
.Vb 3
\&    my $r = qr/... (?{ foo() if ... }) .../;
\&    sub foo { $string =~ $r }
\&    foo()
.Ve
.IP \(bu 4
In some cases an \f(CW\*(C`eval\*(C'\fR would not add integer parts to the source
lines saved by the debugger. [GH #23151 <https://github.com/Perl/perl5/issues/23151>]
.IP \(bu 4
In debugging mode, perl saves source lines from all files
(plus an indication of whether each line is breakable)
for use by the debugger. The internal storage format has been
optimized to use less memory.
This should save 24 bytes per stored line for 64\-bit
systems, more for \f(CW\*(C`\-Duselongdouble\*(C'\fR or \f(CW\*(C`\-Dusequadmath\*(C'\fR builds.
Discussed in [GH #23171 <https://github.com/Perl/perl5/issues/23171>].
.IP \(bu 4
Ensure cloning the save stack for fork emulation doesn\*(Aqt duplicate
freeing the RExC state. [GH #23022 <https://github.com/Perl/perl5/issues/23022>]
.IP \(bu 4
Smartmatch against a code reference that uses a loop exit such as
\&\f(CW\*(C`last\*(C'\fR would crash perl. [GH #16608 <https://github.com/Perl/perl5/issues/16608>]
.IP \(bu 4
Class initializers and \f(CW\*(C`ADJUST\*(C'\fR blocks, per perlclass, that
called \f(CW\*(C`last\*(C'\fR or other loop exits would crash perl.  Same cause as
for [GH #16608 <https://github.com/Perl/perl5/issues/16608>].
.IP \(bu 4
Exceptions thrown and caught entirely within a \f(CW\*(C`defer {}\*(C'\fR or \f(CW\*(C`finally {}\*(C'\fR
block no longer stop the outer run\-loop.
.Sp
Code such as the following would stop running the contents of the \f(CW\*(C`defer\*(C'\fR
block once the inner exception in the inner \f(CW\*(C`try\*(C'\fR/\f(CW\*(C`catch\*(C'\fR block was caught.
This has now been fixed, and runs as expected. ([GH #23064 <https://github.com/Perl/perl5/issues/23064>]).
.Sp
.Vb 3
\&    defer {
\&        try { die "It breaks\en"; }
\&        catch ($e) { warn $e }
\&
\&        say "This line would never run";
\&    }
.Ve
.IP \(bu 4
"readline" in perlfunc now clears the error flag if an error occurs when
reading and that error is \f(CW\*(C`EAGAIN\*(C'\fR or \f(CW\*(C`EWOULDBLOCK\*(C'\fR.  This allows
code that depended on \f(CW\*(C`readline\*(C'\fR to clear all errors to ignore
these relatively harmless errors.  [GH #22883 <https://github.com/Perl/perl5/issues/22883>]
.IP \(bu 4
\&\f(CW\*(C`open\*(C'\fR automatically creates an anonymous temporary file
when passed \f(CW\*(C`undef\*(C'\fR as a filename:
.Sp
.Vb 1
\&    open(my $fh, "+>", undef) or die ...
.Ve
.Sp
This is supposed to work only when the undefined value is the one returned by
the \f(CW\*(C`undef\*(C'\fR function.
.Sp
In perls before 5.41.3, this caused a problem due to the fact that the same
undefined value can be generated by lookups of non\-existent hash keys or array
elements, which can lead to bugs in user\-level code (reported as [GH #22385 <https://github.com/Perl/perl5/issues/22385>]).
.Sp
In 5.41.3, additional checks based on the syntax tree of the call site were
added, which fixed this issue for some number of common cases, though not all
of them, at the cost of breaking the ability of APIs that wrap \f(CW\*(C`open\*(C'\fR to
expose its anonymous file mode. A notable example of such an API is autodie.
.Sp
This release reverts to the old problem in preference to the new one for the
time being.
.SH Obituaries
.IX Header "Obituaries"
.SS "Abe Timmerman"
.IX Subsection "Abe Timmerman"
Abe Timmerman (ABELTJE) passed away on August 15, 2024.
.PP
Since 2002, Abe built and maintained the Test::Smoke project: "a
set of scripts and modules that try to run the Perl core tests on as
many configurations as possible and combine the results into an easy to
read report". Smoking Perl on as many platforms and configurations as
possible has been instrumental in finding bugs and developing patches
for those bugs.
.PP
Abe was a regular attendee of the Perl Toolchain Summit (n√©e Perl QA
Hackathon), the Dutch Perl Workshop and the Amsterdam.pm user group
meetings. With his kindness, his smile and his laugh, he helped make
Perl and its community better.
.PP
Abeltje\*(Aqs memorial card said "Grab every opportunity to have a drink of
bubbly. This is an opportunity". We\*(Aqll miss you Abe, and we\*(Aqll have a
drink of bubbly in your honor.
.SS "Andrew Main"
.IX Subsection "Andrew Main"
Andrew Main (ZEFRAM) passed away on March 10, 2025.
.PP
Zefram was a brilliant person, seemingly knowledgeable in everything
and happy to impart his knowledge and share his striking insights with a
gentle, technical demeanor that often failed to convey the genuine care
with which he communicated.
.PP
It would be impossible to overstate the impact that Zefram has had on
both the language and culture of Perl over the years. From his countless
contributions to the code\-base, to his often quirky but always distinctive
appearances at conferences and gatherings, his influence and memory are
sure to endure long into the future.
.PP
Zefram wished to have no designated memorial location in
meatspace. His designated memorial location in cyberspace is
<http://www.fysh.org/~zefram/personal/>.
.SH Acknowledgements
.IX Header "Acknowledgements"
Perl 5.42.0 represents approximately 13 months of development since Perl
5.40.0 and contains approximately 280,000 lines of changes across 1,600
files from 65 authors.
.PP
Excluding auto\-generated files, documentation and release tools, there were
approximately 94,000 lines of changes to 860 .pm, .t, .c and .h files.
.PP
Perl continues to flourish into its fourth decade thanks to a vibrant
community of users and developers. The following people are known to have
contributed the improvements that became Perl 5.42.0:
.PP
Aaron Dill, Andrei Horodniceanu, Andrew Ruthven, Antanas Vaitkus, Aristotle
Pagaltzis, Branislav Zahradn√≠k, brian d foy, Chad Granum, Chris \*(AqBinGOs\*(Aq
Williams, Craig A. Berry, Dabrien \*(AqDabe\*(Aq Murphy, Dagfinn Ilmari Manns√•ker,
Dan Book, Daniel Dragan, Dan Jacobson, David Cantrell, David Mitchell, E.
Choroba, Ed J, Ed Sabol, Elvin Aslanov, Eric Herman, Erik Huelsmann, Gianni
Ceccarelli, Graham Knop, hbmaclean, H.Merijn Brand, iabyn, James E Keenan,
James Raspass, Johan Vromans, Karen Etheridge, Karl Williamson, Leon
Timmermans, Lukas Mai, Marek Rouchal, Marin Tsanov, Mark Fowler, Masahiro
Honma, Max Maischein, Paul Evans, Paul Johnson, Paul Marquess, Peter
Eisentraut, Peter John Acklam, Philippe Bruhat (BooK), pyrrhlin, Reini
Urban, Richard Leach, Robert Rothenberg, Robin Ragged, Russ Allbery, Scott
Baker, Sergei Zhmylev, Sevan Janiyan, Sisyphus, ≈†tƒõp√°n Nƒõmec, Steve Hay,
TAKAI Kousuke, Thibault Duponchelle, Todd Rinaldo, Tony Cook, Unicode
Consortium, Vladim√≠r Marek, Yves Orton.
.PP
The list above is almost certainly incomplete as it is automatically
generated from version control history. In particular, it does not include
the names of the (very much appreciated) contributors who reported issues to
the Perl bug tracker.
.PP
Many of the changes included in this version originated in the CPAN modules
included in Perl\*(Aqs core. We\*(Aqre grateful to the entire CPAN community for
helping Perl to flourish.
.PP
For a more complete list of all of Perl\*(Aqs historical contributors, please
see the \fIAUTHORS\fR file in the Perl source distribution.
.SH "Reporting Bugs"
.IX Header "Reporting Bugs"
If you find what you think is a bug, you might check the perl bug database
at <https://github.com/Perl/perl5/issues>. There may also be information at
<https://www.perl.org/>, the Perl Home Page.
.PP
If you believe you have an unreported bug, please open an issue at
<https://github.com/Perl/perl5/issues>. Be sure to trim your bug down to a
tiny but sufficient test case.
.PP
If the bug you are reporting has security implications which make it
inappropriate to send to a public issue tracker, then see
"SECURITY VULNERABILITY CONTACT INFORMATION" in perlsec
for details of how to report the issue.
.SH "Give Thanks"
.IX Header "Give Thanks"
If you wish to thank the Perl 5 Porters for the work we had done in Perl 5,
you can do so by running the \f(CW\*(C`perlthanks\*(C'\fR program:
.PP
.Vb 1
\&    perlthanks
.Ve
.PP
This will send an email to the Perl 5 Porters list with your show of thanks.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
The \fIChanges\fR file for an explanation of how to view exhaustive details on
what changed.
.PP
The \fIINSTALL\fR file for how to build Perl.
.PP
The \fIREADME\fR file for general stuff.
.PP
The \fIArtistic\fR and \fICopying\fR files for copyright information.
